<HTML xmlns="http://www.w3.org/1999/xhtml">
    <HEAD>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta name="description" content="" />
        <meta name="author" content="Matthias Edler-Golla, wachenfeld-golla.de" />
        <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=no;" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <meta http-equiv="pragram" content="no-cache"/> 
        <meta http-equiv="cache-control" content="no-cache, must-revalidate"/> 
        <meta http-equiv="expires" content="0"/> 

        <!-- <link rel="apple-touch-icon-precomposed" href="/p/logo_home_iphone.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/p/logo_home_ipad.png" />
        <link rel="shortcut icon" href="/favicon.ico" />
        <link rel="apple-touch-startup-image" href="/p/StartupGraphic.png" />
        <link rel="stylesheet" href="/c/stylesheet.css" />
        <link rel="stylesheet" href="/c/style.css" /> -->
        <style type="text/css">
            body{
                // background-image: url(img/default.jpg); 
                background: gray; 
                background-size: 100%;

                -moz-user-select: none; /*ff*/
                -webkit-user-select: none; /*webkit*/
                -ms-user-select: none; /*IE10*/
                -khtml-user-select: none; /*old*/
                user-select: none;
            }
            #wrap{
                position:relative;
                margin: auto;
            }
            #main{
                position:relative; 
                //margin: auto;
                padding:0;
                top:0;
                left:0;
                background-color: white;
                //border:1px solid red;
            }
            .textCenter{
                //MARGIN-LEFT: auto;
                vertical-align:middle;
                text-align:center;
                //word-wrap:break-word;
                text-overflow: ellipsis; 
                overflow: hidden; 
                white-space: nowrap; 
            }
        </style>
        <link href="js/jqueryui/jqueryui.css" rel="stylesheet" type="text/css"/>
        <link href="css/nav.css" rel="stylesheet" type="text/css"/> 
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
        <!-- this script helps older IE versions to understand html5 -->
        <!--[if lt IE 9 ]>
            <script src="js/html5.js"></script>
        <![endif]-->
        <script type="text/javascript" src="/js/utility.js"></script>
        <script type="text/javascript" src="/js/storage.js"></script>
        <script type="text/javascript" src="/js/bigint.js"></script>
        <script type="text/javascript" src="/js/encrypt.js"></script>
        <script type="text/javascript" src="/js/ajax.js"></script>
        <script type="text/javascript" src="/js/login.js"></script>
        <script type="text/javascript" src="/js/pagecommon.js"></script>
        <script type="text/javascript" src="/js/binding.js"></script>
        <script type="text/javascript" src="js/jquery.js"></script>
        <script type="text/javascript" src="js/jqueryui/jqueryui.js"></script>
        <script type="text/javascript" src="js/render.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-firestore.js"></script>
    </HEAD>
    <BODY onload="loadPage()">  
        <DIV  id="wrap">
                        <div id="main" onclick="hideMenu()" style="width: 1420px; height: 880px; background-image: url(file:///D:/documentos/Silo/NetBeansProjects/Silo_Web/img/9599BBF5.png); background-size: 1420px 880px; margin: 0px; padding: 0px; top: 0px; left: 0px; background-position: 0px 0px; background-repeat: no-repeat no-repeat;" prefix="Siemens" bg_image="img/9599BBF5.png">










<div comp_type="CustomizedComponent" show_function="loadCustomizedComponent" class="server_binding textCenter" style="line-height: 254px; position: absolute; left: 273px; top: 125px; width: 186px; height: 254px; text-align: center; background-size: 186px 255px; transform: rotate(0deg); background-image: url(file:///D:/documentos/Silo/NetBeansProjects/Silo_Web/img/0B1114AF.png); z-index: 6; background-repeat: no-repeat no-repeat;" range="130" address="0" type="1" length="1" on_text="" off_text="" id="1578617245821137" show_param="1578617245821137" degree="0" tag_id="Private Tag" on_image="img/7721D752.png" off_image="img/0B1114AF.png" mode="false"></div>










<script type="text/javascript">var loadCustomizedComponent = function loadCustomizedComponent() {    var id = this.m_sShowParam;    var ontext = document.getElementById(id).getAttribute("on_text");    var offtext = document.getElementById(id).getAttribute("off_text");    var onimage = document.getElementById(id).getAttribute("on_image");    var offimage = document.getElementById(id).getAttribute("off_image");    var value = parseInt(this.m_sValue, 16);    document.getElementById(id).value = value;    if (value == 0) {        document.getElementById(id).innerHTML = offtext;        document.getElementById(id).style.backgroundImage = "url(" + offimage + ")";    } else {        document.getElementById(id).innerHTML = ontext;        document.getElementById(id).style.backgroundImage = "url(" + onimage + ")";    }};</script>










<div comp_type="CustomizedComponent" show_function="loadCustomizedComponent" class="server_binding textCenter" style="line-height: 231px; position: absolute; left: 286px; top: 137px; width: 159px; height: 231px; text-align: center; background-size: 159px 232px; transform: rotate(0deg); background-image: url(file:///D:/documentos/Silo/NetBeansProjects/Silo_Web/img/DD670257.png); z-index: 7; background-repeat: no-repeat no-repeat;" range="130" address="0" type="1" length="1" on_text="" off_text="" id="1578617245908138" show_param="1578617245908138" degree="0" tag_id="Private Tag" on_image="img/DD670257.png" off_image="img/DD670257.png" mode="false"></div>










<script type="text/javascript">var loadCustomizedComponent = function loadCustomizedComponent() {    var id = this.m_sShowParam;    var ontext = document.getElementById(id).getAttribute("on_text");    var offtext = document.getElementById(id).getAttribute("off_text");    var onimage = document.getElementById(id).getAttribute("on_image");    var offimage = document.getElementById(id).getAttribute("off_image");    var value = parseInt(this.m_sValue, 16);    document.getElementById(id).value = value;    if (value == 0) {        document.getElementById(id).innerHTML = offtext;        document.getElementById(id).style.backgroundImage = "url(" + offimage + ")";    } else {        document.getElementById(id).innerHTML = ontext;        document.getElementById(id).style.backgroundImage = "url(" + onimage + ")";    }};</script>










<div comp_type="CustomizedComponent" show_function="loadCustomizedComponent" class="server_binding textCenter" style="line-height: 76px; position: absolute; left: 324px; top: 271px; width: 83px; height: 76px; text-align: center; background-size: 83px 77px; transform: rotate(0deg); background-image: url(file:///D:/documentos/Silo/NetBeansProjects/Silo_Web/img/9538DB25.gif); z-index: 8; background-repeat: no-repeat no-repeat;" range="130" address="0" type="1" length="1" on_text="" off_text="" id="1578617245923139" show_param="1578617245923139" degree="0" tag_id="Private Tag" on_image="img/87702A79.gif" off_image="img/9538DB25.gif" mode="false"></div>










<script type="text/javascript">var loadCustomizedComponent = function loadCustomizedComponent() {    var id = this.m_sShowParam;    var ontext = document.getElementById(id).getAttribute("on_text");    var offtext = document.getElementById(id).getAttribute("off_text");    var onimage = document.getElementById(id).getAttribute("on_image");    var offimage = document.getElementById(id).getAttribute("off_image");    var value = parseInt(this.m_sValue, 16);    document.getElementById(id).value = value;    if (value == 0) {        document.getElementById(id).innerHTML = offtext;        document.getElementById(id).style.backgroundImage = "url(" + offimage + ")";    } else {        document.getElementById(id).innerHTML = ontext;        document.getElementById(id).style.backgroundImage = "url(" + onimage + ")";    }};</script>





<script type="text/javascript">var loadCustomizedComponent = function loadCustomizedComponent() {    var id = this.m_sShowParam;    var ontext = document.getElementById(id).getAttribute("on_text");    var offtext = document.getElementById(id).getAttribute("off_text");    var onimage = document.getElementById(id).getAttribute("on_image");    var offimage = document.getElementById(id).getAttribute("off_image");    var value = parseInt(this.m_sValue, 16);    document.getElementById(id).value = value;    if (value == 0) {        document.getElementById(id).innerHTML = offtext;        document.getElementById(id).style.backgroundImage = "url(" + offimage + ")";    } else {        document.getElementById(id).innerHTML = ontext;        document.getElementById(id).style.backgroundImage = "url(" + onimage + ")";    }};</script>





<script type="text/javascript">    var loadAnalogTimeComponent = function loadAnalogTimeComponent() {        var id = this.m_sShowParam;        var blockFormat = $("#" + id).attr("block_format");        var accessModeType = $("#" + id).attr("type");        var signedValue = Unsigned2Signed(parseInt(this.m_sValue, 16), accessModeType);        var actVal = "#";        if (signedValue>=0) {             actVal = getValueByBlockFormat(blockFormat, accessModeType, this.m_sValue);            var time_format = $("#" + id).attr("time_format");            if (time_format == "m") {                actVal = getMinFormatTimeByVmVal(actVal);            } else if (time_format == "s") {                actVal = getSecFormatTimeByVmVal(actVal);            } else if (time_format == "ms") {                actVal = getMsFormatTimeByVmVal(actVal);            }        }                 $("#" + id).children(".valueText").children(".inputVal").attr("placeholder", actVal);        $("#" + id).attr("last_placeholder", actVal);    }</script>





<script type="text/javascript">    var loadAnalogTimeComponent = function loadAnalogTimeComponent() {        var id = this.m_sShowParam;        var blockFormat = $("#" + id).attr("block_format");        var accessModeType = $("#" + id).attr("type");        var signedValue = Unsigned2Signed(parseInt(this.m_sValue, 16), accessModeType);        var actVal = "#";        if (signedValue>=0) {             actVal = getValueByBlockFormat(blockFormat, accessModeType, this.m_sValue);            var time_format = $("#" + id).attr("time_format");            if (time_format == "m") {                actVal = getMinFormatTimeByVmVal(actVal);            } else if (time_format == "s") {                actVal = getSecFormatTimeByVmVal(actVal);            } else if (time_format == "ms") {                actVal = getMsFormatTimeByVmVal(actVal);            }        }                 $("#" + id).children(".valueText").children(".inputVal").attr("placeholder", actVal);        $("#" + id).attr("last_placeholder", actVal);    }</script>










<div class="TextComponent" comp_type="TextComponent" style="overflow: hidden; line-height: 100%; position: absolute; left: 342px; top: 158px; width: 84px; height: 41px; text-align: center; background-size: 84px 42px; transform: rotate(0deg); font-style: normal; font-family: Arial; font-size: 14px; color: rgb(0, 0, 0); z-index: 9; background-repeat: no-repeat no-repeat;" id="159617990488188" degree="0">    







<p style="display:table-cell; vertical-align:middle;text-align: center; ">SILO 1</p>







</div>







<div class="server_binding analog_input" comp_type="AnalogValueComponent" show_function="loadAnalogValueComponent" style="border: 0px solid red; position: absolute; left: 325px; top: 233px; width: 84px; height: 22px; text-align: center; background-size: 84px 23px; transform: rotate(0deg); z-index: 5; background-repeat: no-repeat no-repeat;" range="20" address="0" type="4" length="1" show_param="159618002589789" id="159618002589789" degree="0" tag_id="Private Tag" block_format="Unsigned" mode="true">    







<div class="valueText" style="">        







<input class="inputVal" type="text" size="5" value="" style="width:100%;height:100%">        <span class="unit" style="position: absolute; top: 4px; left: 86px;"></span>    







</div>    







<div class="notice" style="color: red;"></div>







</div>







<script type="text/javascript">    var loadAnalogValueComponent = function loadAnalogInputComponent() {        var id = this.m_sShowParam;        var blockFormat = $("#" + id).attr("block_format");        var accessModeType = $("#" + id).attr("type");        $("#" + id).attr("title", blockFormat);        var value = getValueByBlockFormat(blockFormat, accessModeType, this.m_sValue);        var actVal = value;        $("#" + id).children(".valueText").children(".inputVal").attr("placeholder", actVal);        $("#" + id).attr("last_placeholder", actVal);    }</script><script type="text/javascript">    var showDateTime = function showDateTime() {        if(this.m_sValue&&this.m_sValue.length==12){            var sv = this.m_sValue;            var sec = getValueByBlockFormat("Unsigned", "2", sv.substr(0,2)) + "";            sec = (sec.length == 1) ? "0" + sec : sec;            var date = "20" + sv.substr(2,2) + " - " + sv.substr(4,2) + " - " + sv.substr(6,2);            var time = sv.substr(8,2) + ":" + sv.substr(10,2) + ":" + sec;            var dayNo = new Date(parseInt("20" + sv.substr(2,2)), sv.substr(4,2)-1, sv.substr(6,2)).getDay();                $("#" + this.m_sShowParam + " .dayTime").html(WEEKDAY[dayNo] + " " + time);            $("#" + this.m_sShowParam + " .date").html(date);        }else{            $("#" + this.m_sShowParam + " .dayTime").html("ddd. HH:mm:ss");            $("#" + this.m_sShowParam + " .date").html("yyyy-MM-dd");            console.error("LWE runtime error: AnalogDateTimeComponent connect error!");        }    }</script>







<div class="server_binding analog_input" comp_type="AnalogValueComponent" show_function="loadAnalogValueComponent" style="border: 0px solid red; position: absolute; left: 325px; top: 271px; width: 84px; height: 22px; text-align: center; background-size: 84px 23px; transform: rotate(0deg); z-index: 4; background-repeat: no-repeat no-repeat;" range="20" address="16" type="4" length="1" show_param="159881299939318" id="159881299939318" degree="0" tag_id="Private Tag" block_format="Unsigned" mode="true">    






<div class="valueText" style="">        






<input class="inputVal" type="text" size="5" value="" style="width:100%;height:100%">        <span class="unit" style="position: absolute; top: 4px; left: 86px;"></span>    






</div>    






<div class="notice" style="color: red;"></div>






</div>






<script type="text/javascript">    var loadAnalogValueComponent = function loadAnalogInputComponent() {        var id = this.m_sShowParam;        var blockFormat = $("#" + id).attr("block_format");        var accessModeType = $("#" + id).attr("type");        $("#" + id).attr("title", blockFormat);        var value = getValueByBlockFormat(blockFormat, accessModeType, this.m_sValue);        var actVal = value;        $("#" + id).children(".valueText").children(".inputVal").attr("placeholder", actVal);        $("#" + id).attr("last_placeholder", actVal);    }</script>






<div class="server_binding analog_input" comp_type="AnalogValueComponent" show_function="loadAnalogValueComponent" style="border: 0px solid red; position: absolute; left: 324px; top: 309px; width: 84px; height: 22px; text-align: center; background-size: 84px 23px; transform: rotate(0deg); z-index: 3; background-repeat: no-repeat no-repeat;" range="20" address="32" type="4" length="1" show_param="159881300338619" id="159881300338619" degree="0" tag_id="Private Tag" block_format="Unsigned" mode="true">    






<div class="valueText" style="">        






<input class="inputVal" type="text" size="5" value="" style="width:100%;height:100%">        <span class="unit" style="position: absolute; top: 4px; left: 86px;"></span>    






</div>    






<div class="notice" style="color: red;"></div>






</div>






<script type="text/javascript">    var loadAnalogValueComponent = function loadAnalogInputComponent() {        var id = this.m_sShowParam;        var blockFormat = $("#" + id).attr("block_format");        var accessModeType = $("#" + id).attr("type");        $("#" + id).attr("title", blockFormat);        var value = getValueByBlockFormat(blockFormat, accessModeType, this.m_sValue);        var actVal = value;        $("#" + id).children(".valueText").children(".inputVal").attr("placeholder", actVal);        $("#" + id).attr("last_placeholder", actVal);    }</script>               






<div comp_type="CustomizedComponent" show_function="loadCustomizedComponent" class="server_binding textCenter" style="position: absolute; left: 342px; top: 397px; width: 57px; height: 34px; text-align: center; background-size: 57px 35px; line-height: 34px; transform: rotate(0deg); background-image: url(file:///D:/documentos/Silo/NetBeansProjects/Silo_Web/img/982170EF.png); z-index: 10; background-repeat: no-repeat no-repeat;" range="131" address="0" type="1" length="1" on_text="" off_text="" id="1598814665412101" show_param="1598814665412101" degree="0" tag_id="Private Tag" on_image="img/AC2417CB.png" off_image="img/982170EF.png" mode="true" onclick="setDigitalData(this.value,this.id)"></div>






<script type="text/javascript">    var loadCustomizedComponent = function loadCustomizedComponent() {        var id = this.m_sShowParam;        var ontext = document.getElementById(id).getAttribute("on_text");        var offtext = document.getElementById(id).getAttribute("off_text");        var onimage = document.getElementById(id).getAttribute("on_image");        var offimage = document.getElementById(id).getAttribute("off_image");        var value = parseInt(this.m_sValue, 16);        document.getElementById(id).value = value;        var showText = (value == 0) ? offtext : ontext;        var showImage = (value == 0) ? offimage : onimage;        if ($("#" + id + " p").length == 0) {            document.getElementById(id).innerHTML = showText;        } else {            $("#" + id + " p").html(showText);        }        document.getElementById(id).style.backgroundImage = "url(" + showImage + ")";    };</script>






<div class="TextComponent" comp_type="TextComponent" style="overflow: hidden; line-height: 100%; position: absolute; left: 273px; top: 23px; width: 482px; height: 70px; text-align: center; background-size: 482px 71px; transform: rotate(0deg); font-style: normal; font-family: Arial; font-size: 24px; color: rgb(51, 51, 0); z-index: 11; background-repeat: no-repeat no-repeat;" id="1598814776395134" degree="0">    






<p style="display:table-cell; vertical-align:middle;text-align: center; ">Modo Automatico "Silo 1"</p>






</div>






<div comp_type="RectangleComponent" style="border: 0px solid rgb(0, 0, 0); position: absolute; left: 511px; top: 153px; width: 333px; height: 258px; text-align: center; background-size: 333px 259px; transform: rotate(0deg); zoom: 1; opacity: 1; z-index: 12; background-repeat: no-repeat no-repeat;" id="1602302561177242" degree="0">

    <div>
        <div>
            <div id="form">
<fieldset>
        <legend>Datos</legend>
        <label for="humedad">Humedad:</label>
        <select name="humedad" id="humedad">
            <option value="10">Muy Seco</option>
            <option value="11">Seco</option>
            <option value="14">Humedo</option>
            <option value="16">Muy Humedo</option>
        </select>
        <br><br>
        <label for="">Toneladas:</label>
        <input type="text" id="toneladas">
        <br><br>
        <label for="temperatura">Temperatura:</label>
        <select name="temperatura" id="temperatura">
                    <option value="15">Frio</option>
                    <option value="22">Normal</option>
                    <option value="30">Caliente</option>
                    <option value="35">Muy Caliente</option>
                </select>
        <br><br>
        <label for="grano">Selecciones el Grano:</label>
        <select name="grano" id="grano">
            <option value="cebada">Cebada</option>
            <option value="maiz">Maiz</option>
            <option value="trigo">Trigo</option>
            <option value="soja">Soja</option>
        </select>
        <br><br>
        <input type="button" onclick="calcular()" value="Calucular">
        </fieldset>
    </div>
    <div id="datos">
  <fieldset>
      <legend>Informacion de Grano</legend>
      <p id='info_marcha'>Marcha: Datos no Ingresados (hs)</p>
      <p id='info_descanso'>descanso: Datos no Ingresados (hs)</p>
      <p id='info_total'>Total horas: Datos no Ingresados (hs)</p>
      <p id='info_grano'>Grano: Datos no Ingresados (hs)</p>
      <p id='info_toneladas'>Tonaladas: Datos no Ingresados (hs)</p>
      <p id='info_humedad'>Humedad: Datos no Ingresados (hs)</p>
      <p id='info_temperatura'>Temperatura: Datos no Ingresados (hs)</p>
      <input type="button" onclick="cambiar_estado(false); setDigitalData(1,1598814665412101)" value="CANCELAR">
  <fieldset>
</div>
</div>
</div>
                        </div></div> 
                        
                        

</div>
                            </div>
                        </div></div> 
                        
                        

</div>
                        

</div>

<script type="text/javascript">    var loadCustomizedComponent = function loadCustomizedComponent() {        var id = this.m_sShowParam;        var ontext = document.getElementById(id).getAttribute("on_text");        var offtext = document.getElementById(id).getAttribute("off_text");        var onimage = document.getElementById(id).getAttribute("on_image");        var offimage = document.getElementById(id).getAttribute("off_image");        var value = parseInt(this.m_sValue, 16);        document.getElementById(id).value = value;        var showText = (value == 0) ? offtext : ontext;        var showImage = (value == 0) ? offimage : onimage;        if ($("#" + id + " p").length == 0) {            document.getElementById(id).innerHTML = showText;        } else {            $("#" + id + " p").html(showText);        }        document.getElementById(id).style.backgroundImage = "url(" + showImage + ")";    };</script>
<div class="server_binding analog_input" comp_type="AnalogValueComponent" show_function="loadAnalogValueComponent" style="border: 0px solid red; position: absolute; left: 286px; top: 148px; width: 22px; height: 22px; text-align: center; background-size: 22px 23px; transform: rotate(0deg); z-index: 2; background-repeat: no-repeat no-repeat;" range="20" address="768" type="4" length="1" show_param="1602472376430127" id="1602472376430127" degree="0" tag_id="Private Tag" block_format="Unsigned" mode="true">    
<div class="valueText" style="">        
<input class="inputVal" type="text" size="5" value="" style="width:100%;height:100%">        <span class="unit" style="position: absolute; top: 4px; left: 24px;"></span>    
</div>    
<div class="notice" style="color: red;"></div>
</div>
<script type="text/javascript">    var loadAnalogValueComponent = function loadAnalogInputComponent() {        var id = this.m_sShowParam;        var blockFormat = $("#" + id).attr("block_format");        var accessModeType = $("#" + id).attr("type");        $("#" + id).attr("title", blockFormat);        var value = getValueByBlockFormat(blockFormat, accessModeType, this.m_sValue);        var actVal = value;        $("#" + id).children(".valueText").children(".inputVal").attr("placeholder", actVal);        $("#" + id).attr("last_placeholder", actVal);    }</script>
<div comp_type="analogDateTimeComponent" class="server_binding" show_function="showDateTime" range="132" address="7920" type="2" length="6" show_param="1602532867974273" block_format="Unsigned" style="overflow: hidden; line-height: 100%; text-align: center; position: absolute; left: 605px; top: 13px; width: 104px; height: 44px; background-size: 104px 45px; transform: rotate(0deg); font-style: normal; font-family: Arial; font-size: 14px; color: rgb(0, 0, 0); z-index: 13; background-repeat: no-repeat no-repeat;" id="1602532867974273" degree="0">    <div style="position:relative;top:20%">        <div class="dayTime">ddd. HH:mm:ss</div>        <div class="date">yyyy-MM-dd</div>    </div></div><script type="text/javascript">    var showDateTime = function showDateTime() {        if(this.m_sValue&&this.m_sValue.length==12){            var sv = this.m_sValue;            var sec = getValueByBlockFormat("Unsigned", "2", sv.substr(0,2)) + "";            sec = (sec.length == 1) ? "0" + sec : sec;            var date = "20" + sv.substr(2,2) + " - " + sv.substr(4,2) + " - " + sv.substr(6,2);            var time = sv.substr(8,2) + ":" + sv.substr(10,2) + ":" + sec;            var dayNo = new Date(parseInt("20" + sv.substr(2,2)), sv.substr(4,2)-1, sv.substr(6,2)).getDay();                $("#" + this.m_sShowParam + " .dayTime").html(WEEKDAY[dayNo] + " " + time);            $("#" + this.m_sShowParam + " .date").html(date);        }else{            $("#" + this.m_sShowParam + " .dayTime").html("ddd. HH:mm:ss");            $("#" + this.m_sShowParam + " .date").html("yyyy-MM-dd");            console.error("LWE runtime error: AnalogDateTimeComponent connect error!");        }    }</script><div class="server_binding analog_input" comp_type="AnalogValueComponent" show_function="loadAnalogValueComponent" style="border: 0px solid red; position: absolute; left: 840px; top: 23px; width: 37px; height: 22px; text-align: center; background-size: 37px 23px; transform: rotate(0deg); z-index: 14; background-repeat: no-repeat no-repeat;" range="20" address="784" type="4" length="1" show_param="1602532867996274" id="1602532867996274" degree="0" tag_id="Private Tag" block_format="Signed" mode="false">    <div class="valueText" style="">        <input id="id_humedad" class="inputVal" type="text" size="5" value="" style="width:100%;height:100%">        <span class="unit" style="position: absolute; top: 4px; left: 39px;">%</span>    </div>    <div class="notice" style="color: red;"></div></div><script type="text/javascript">    var loadAnalogValueComponent = function loadAnalogInputComponent() {        var id = this.m_sShowParam;        var blockFormat = $("#" + id).attr("block_format");        var accessModeType = $("#" + id).attr("type");        $("#" + id).attr("title", blockFormat);        var value = getValueByBlockFormat(blockFormat, accessModeType, this.m_sValue);        var actVal = value;        $("#" + id).children(".valueText").children(".inputVal").attr("placeholder", actVal);        $("#" + id).attr("last_placeholder", actVal);    }</script><div class="TextComponent" comp_type="TextComponent" style="overflow: hidden; line-height: 100%; position: absolute; left: 766px; top: 23px; width: 65px; height: 34px; text-align: center; background-size: 65px 35px; transform: rotate(0deg); font-style: normal; font-family: Arial; font-size: 14px; color: rgb(0, 0, 0); z-index: 15; background-repeat: no-repeat no-repeat;" id="1602532868001275" degree="0">    <p style="display:table-cell; vertical-align:middle;text-align: center; ">Humedad:</p></div><div class="server_binding analog_input" comp_type="AnalogValueComponent" show_function="loadAnalogValueComponent" style="border: 0px solid red; position: absolute; left: 840px; top: 61px; width: 37px; height: 22px; text-align: center; background-size: 37px 23px; transform: rotate(0deg); z-index: 16; background-repeat: no-repeat no-repeat;" range="20" address="800" type="4" length="1" show_param="1602532868004276" id="1602532868004276" degree="0" tag_id="Private Tag" block_format="Signed" mode="false">    <div class="valueText" style="">        <input id="id_temperatura" class="inputVal" type="text" size="5" value="" style="width:100%;height:100%">        <span class="unit" style="position: absolute; top: 4px; left: 39px;">%</span>    </div>    <div class="notice" style="color: red;"></div></div><script type="text/javascript">    var loadAnalogValueComponent = function loadAnalogInputComponent() {        var id = this.m_sShowParam;        var blockFormat = $("#" + id).attr("block_format");        var accessModeType = $("#" + id).attr("type");        $("#" + id).attr("title", blockFormat);        var value = getValueByBlockFormat(blockFormat, accessModeType, this.m_sValue);        var actVal = value;        $("#" + id).children(".valueText").children(".inputVal").attr("placeholder", actVal);        $("#" + id).attr("last_placeholder", actVal);    }</script><div class="TextComponent" comp_type="TextComponent" style="overflow: hidden; line-height: 100%; position: absolute; left: 747px; top: 61px; width: 84px; height: 34px; text-align: center; background-size: 84px 35px; transform: rotate(0deg); font-style: normal; font-family: Arial; font-size: 14px; color: rgb(0, 0, 0); z-index: 17; background-repeat: no-repeat no-repeat;" id="1602532868009277" degree="0">    <p style="display:table-cell; vertical-align:middle;text-align: center; ">Temperatura:</p></div><div class="TextComponent" comp_type="TextComponent" style="overflow: hidden; line-height: 100%; position: absolute; left: 255px; top: 410px; width: 84px; height: 34px; text-align: center; background-size: 84px 35px; transform: rotate(0deg); font-style: normal; font-family: Arial; font-size: 14px; color: rgb(0, 0, 0); z-index: 18; background-repeat: no-repeat no-repeat;" id="1602533149953344" degree="0">    <p style="display:table-cell; vertical-align:middle;text-align: center; ">Automatico</p></div></div> 
     
<script type="text/javascript">

    function setDigitalData(value,id) {
        var oRequest = new DBRequest(document.getElementById(id));
        if (value) {
            oRequest.SetValue("00");
        } else {
            oRequest.SetValue("01");
        }
        if (oRequest.SetQuery()) {
            intervalId = setInterval(checkResult, 1000, oRequest);
        }
        return false;
    }

    let silo = "silo1";
    let fraccion = 50; 
    let id_1 = "159618002589789";
    let id_2 = "159881299939318";
    let id_3 = "159881300338619";
    let id_4 = "1602472376430127";

    // async function gethumedad(){
    //                     const e = await document.getElementById("id_humedad").placeholder;
    //                     return e;
    //                     }
    //                 gethumedad()
    //                 .then((res) => console.log(res)); 

 
    // let temperatura_actual = document.getElementById("id_temperatura").placeholder;

    // console.log(humedad_actual);
    // console.log(temperatura_actual);

    function getAttribute(element, attribute){
    return new Promise((resolve, reject) => { 
        const observer = new MutationObserver(function(mutations, observer) {
            mutations.forEach(function(mutation) {
                if (mutation.type == "attributes") {
                    if(mutation.attributeName == attribute){
                        observer.disconnect();
                        resolve(element.getAttribute(attribute));
                    }
                }
            });
        });
        
        observer.observe(element, {
            attributes: true //configure it to listen to attribute changes
        });    
    }); 
    }



    firebase.initializeApp({
        apiKey: "AIzaSyAdDIO55DLUnZ0AO15r8Jk0GHWhQulv_Dc",
        authDomain: "prueba1-a6072.firebaseapp.com",
        projectId: "prueba1-a6072"
    });
    
    var db = firebase.firestore();

    var input1 = document.getElementById(id_1);
    input1.style.display = 'none';

    var input2 = document.getElementById(id_2);
    input2.style.display = 'none';
    input2.style.visibility = 'hidden';

    var input3 = document.getElementById(id_3);
    input3.style.display = 'none';

    function cambiar_estado(estado){
        let s = db.collection("estados").doc("estado1");
        s.set({
            estado: estado
        });
        document.getElementById("form").hidden = estado;
        document.getElementById("datos").hidden = !estado;
    }

    function getEstado() {
    let s1 = db.collection("estados").doc("estado1");
            s1.onSnapshot(function(doc) {
                if (doc.exists) {
                        async function getAsincEstado(){
                        const e = await doc.data().estado;
                        return e;
                        }
                    getAsincEstado()
                    .then((res) => cambiar_estado(res)); 
                } else {
                    // doc.data() will be undefined in this case
                    console.log("No such document!");
                }
            }
    );
    }

    function mostrar_datos(){
        let s = db.collection("silos").doc(silo);
        s   .onSnapshot(function(doc) {
            if (doc.exists) {
                console.log("Document data:", doc.data());
                document.getElementById("info_marcha").innerHTML = "Marcha: " + doc.data().marcha + " hs";
                document.getElementById("info_descanso").innerHTML = "descanso: " + doc.data().descanzo + " hs";
                document.getElementById("info_total").innerHTML = "Total horas: " + doc.data().total + " hs";
                document.getElementById("info_toneladas").innerHTML = "Tonaladas: " + doc.data().toneladas + " T";
                document.getElementById("info_grano").innerHTML = "Grano: " + doc.data().grano;
                document.getElementById("info_humedad").innerHTML = "Humedad: " + doc.data().humedad +" %";
                document.getElementById("info_temperatura").innerHTML = "Temperatura: " + doc.data().temperatura + " C";
            } else {
                // doc.data() will be undefined in this case
                console.log("No such document!");
            }
        }
        );
    }

    function dec2hexString(dec) {
        return  (dec+0x10000).toString(16).substr(-4);
    }

    function set_or_update_silo(id,marcha_parcial,descanzo,marcha_total,grano,toneladas,humedad,temperatura){  
    let silo = db.collection("silos").doc(id);
        silo.set({
            marcha: parseInt(marcha_parcial),
            descanzo: parseInt(descanzo),
            total: parseInt(marcha_total),
            grano: grano,
            toneladas: parseInt(toneladas),
            humedad: parseInt(humedad),
            temperatura: parseInt(temperatura)
        });
    }

    function calcular(){

        let grano = document.getElementById('grano').value;
        let temperatura_grano = parseInt(document.getElementById('temperatura').value);
        let toneladas_grano = parseInt(document.getElementById('toneladas').value);
        let humedad_grano = parseInt(document.getElementById('humedad').value);
        let marcha_total = (Math.trunc(toneladas_grano/fraccion) % 2 > 0) ? Math.trunc(toneladas_grano/fraccion)+1 : Math.trunc(toneladas_grano/fraccion);
        let marcha_parcial = 4;
        let descanzo = 2;
        let temperatura_umbral;
        let humedad_humbral;
        let temperatura_actual;
        
        async function getTemperaturaActual(){
            const val = await getAttribute(document.getElementById("id_temperatura"), "placeholder");
            temperatura_actual = parseInt(val);
            console.log(temperatura_actual);
        }
        getTemperaturaActual();

        async function getHumedadActual(){
            const val = await getAttribute(document.getElementById("id_humedad"), "placeholder");
            
            humedad_humbral = parseInt(val);
            console.log(humedad_humbral);
        }
        getHumedadActual();

        switch (grano) {
        case "soja":
            temperatura_umbral = 22;
            humedad_humbral = 12,5;
            break;
        case "cebada":
            temperatura_umbral = 22;
            humedad_humbral = 13,5;
            break;
        case "maiz":
            temperatura_umbral = 22;
            humedad_humbral = 13,5;
            break;
        case "trigo":
            temperatura_umbral = 22;
            humedad_humbral = 13,5;
        }    
        if(13 > 12){          
            doSetAnalogValue(id_1, dec2hexString(marcha_total*60)); // Setea el valor del tiempo total en hexa
            doSetAnalogValue(id_2, dec2hexString(marcha_parcial*60)); // Setea el valor del tiempo en marcha en hexa
            doSetAnalogValue(id_3, dec2hexString(descanzo*60));  // Setea el valor del tiempo total en hexa
            doSetAnalogValue(id_4, dec2hexString(humedad_grano+20));
            cambiar_estado(true);
        }
        if(13 < 12){
            alert("Grano muy seco, no se puede iniciar!");
        }
    
        set_or_update_silo(silo,marcha_parcial,descanzo,marcha_total,grano,toneladas_grano,humedad_grano,temperatura_grano);
        
        mostrar_datos();
    }
    getEstado();
    mostrar_datos();
</script>



        </DIV>
        <div id='timeout_dlg' style='display: none' >Please check the network connection!</div>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js" integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj" crossorigin="anonymous"></script>
    </BODY>
</HTML>

